---
layout: layouts/home
title: "Blogs"
---

<div class="post-window" id="post-window">
  <h1>{{ title }}</h1>
  <p>
    Hello and welcome to my blog! If you want to know about my random thoughts
    and such, keep an eye on this page. I probably just ramble about random
    stuff I did in my life and found interesting, so bear with me.
  </p>
  <div class="post-list">
    <ul>
      {% for post in collections.posts %}
      <li>
        <img src="assets/images/icon_cho.png" alt="Author icon" />
        <p>
          {{ post.data.author }}
          <a
            href="#"
            onclick="loadPost('{{ post.url | url }}', event); return false;"
            >{{ post.data.title }}</a
          >
        </p>
        <p class="post-description">{{post.data.description}}</p>
        <p class="post-date">{{post.data.date}}</p>
        <p class="interactions">
          <img src="assets/images/icon_star.png" alt="Star" />
          <img src="assets/images/icon_retweet.png" alt="Retweet" />
        </p>
      </li>

      {% endfor %}
    </ul>
  </div>
</div>

<div class="ame-window" id="ame-window">
  <img
    class="ame"
    src="assets/images/ame/neutral.png"
    onclick="setAmeExpressionTemp('smiling');"
  />
</div>

<script>
  const win = document.getElementById("post-window");
  const ame = document.getElementById("ame-window");
  const img = ame.querySelector("img.ame");
  const originalListHTML = win.innerHTML;

  function enableDragging(el) {
    if (!el) return;
    if (!window.matchMedia("(min-aspect-ratio: 1/1)").matches) return;

    let dragging = false;
    let startX = 0,
      startY = 0,
      origLeft = 0,
      origTop = 0;

    function px(v) {
      return v + "px";
    }
    function beginDrag(clientX, clientY) {
      const r = el.getBoundingClientRect();
      startX = clientX;
      startY = clientY;
      origLeft = r.left;
      origTop = r.top;
      dragging = true;
    }
    function moveDrag(clientX, clientY) {
      if (!dragging) return;
      const dx = clientX - startX;
      const dy = clientY - startY;
      el.style.left = px(origLeft + dx);
      el.style.top = px(origTop + dy);
    }
    function endDrag() {
      dragging = false;
    }
    el.addEventListener("mousedown", (e) => {
      if (e.target !== el) return;
      beginDrag(e.clientX, e.clientY);
      e.preventDefault();
    });
    window.addEventListener("mousemove", (e) => moveDrag(e.clientX, e.clientY));
    window.addEventListener("mouseup", endDrag);

    el.addEventListener(
      "touchstart",
      (e) => {
        const t = e.touches[0];
        if (e.target !== el) return;
        beginDrag(t.clientX, t.clientY);
      },
      { passive: true }
    );

    window.addEventListener(
      "touchmove",
      (e) => {
        const t = e.touches[0];
        moveDrag(t.clientX, t.clientY);
      },
      { passive: true }
    );

    window.addEventListener("touchend", endDrag);
  }

  enableDragging(win);
  enableDragging(ame);

  async function loadPost(url, event) {
    console.log("Trying to fetch:", url);
    if (event) event.preventDefault();
    try {
      const postContent = await fetch(url);
      const text = await postContent.text();
      win.innerHTML = text;
    } catch (err) {
      console.error("Failed to load post:", err);
    }
  }
  function loadList() {
    win.innerHTML = originalListHTML;
  }

  function setAmeExpressionTemp(expression, length = 1500) {
    if (!ame) return;
    if (!img) return;
    if (img.id == "ame-temp-expression") return;
    img.src = `assets/images/ame/${expression}.png`;
    img.id = "ame-temp-expression";
    setTimeout(() => {
      img.src = `assets/images/ame/neutral.png`;
      img.removeAttribute("id");
    }, length);
  }

  function blink() {
    if (img.id == "ame-temp-expression") return;
    img.src = "assets/images/ame/blink.png";
    setTimeout(() => {
      img.src = "assets/images/ame/neutral.png";
    }, 150);
  }

  function randomExpression() {
    const expressions = ["game", "movie", "obsessed"];
    const expr = expressions[Math.floor(Math.random() * expressions.length)];
    setAmeExpressionTemp(expr, 5000);
  }

  setInterval(randomExpression, 20000);
  setInterval(blink, 3000 + Math.random() * 2000);
</script>
